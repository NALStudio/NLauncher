@using NLauncher.Components
@using NLauncher.Index.Models.Index

@inherits LayoutComponentBase

@layout BaseLayout

<MudLayout>
    <MudAppBar Class="appbar-style" Elevation="0" Color="Color.Transparent">
        <MudText Typo="Typo.h5">NLauncher</MudText>
        <MudSpacer />
        <MudStack Row AlignItems="AlignItems.Center">
            <!-- Use null value to force autocomplete to clear once an app was selected -->
            <MudAutocomplete T="IndexEntry"
                             SearchFunc="SearchIndex"
                             ToStringFunc="@(static e => e.Manifest.DisplayName)"
                             MaxItems="5"
                             Value="null"
                             ValueChanged="@(async e => await NavigateTo(e.Manifest))"
                             Placeholder="Search"
                             Variant="Variant.Outlined"
                             Adornment="Adornment.Start"
                             AdornmentIcon="@(Icons.Material.Rounded.Search)">
            </MudAutocomplete>

            <MudDivider FlexItem Vertical DividerType="DividerType.Middle" Class="mx-4 my-4" />

            <!-- App bar menus -->
            <!-- Use MudPopover instead of MudMenu for better UX since MudMenu behaviour was a bit funky -->
            <MudTooltip Text="Downloads" Delay="1000">
                <MudIconButton Icon="@(Icons.Material.Rounded.Download)" OnClick="ToggleDownloadsMenu" />
            </MudTooltip>
            <DownloadsMenu Open="@downloadsMenuOpen" />

            <MudTooltip Text="Settings" Delay="1000">
                <MudIconButton Icon="@(Icons.Material.Rounded.Settings)" OnClick="ToggleSettingsMenu" />
            </MudTooltip>
            <SettingsMenu Open="@settingsMenuOpen" />
            <!--/ App bar menus /-->

        </MudStack>
    </MudAppBar>
    <MudDrawer Elevation="0" Open Color="Color.Transparent" Variant="DrawerVariant.Persistent" ClipMode="DrawerClipMode.Always">
        <MudNavMenu Rounded Margin="Margin.Normal" Color="Color.Primary">
            <MudNavLink Href="/" Match="NavLinkMatch.All" Icon="@(Icons.Material.Rounded.Home)">Home</MudNavLink>
            <MudNavLink Href="/store" Icon="@(Icons.Material.Rounded.Sell)">Store</MudNavLink>
            <MudNavLink Href="/library" Icon="@(Icons.Material.Rounded.GridView)">Library</MudNavLink>
        </MudNavMenu>
    </MudDrawer>
    <MudMainContent>
        <MudContainer MaxWidth="MaxWidth.ExtraLarge">
            @Body
        </MudContainer>
    </MudMainContent>
</MudLayout>

<MudOverlay Visible="@AnyMenuOpen" LockScroll="false" AutoClose OnClosed="() => SetMenuOpen()" />

<style>
    .appbar-style {
        /* background: rgba(255, 255, 255, 0.2); */
        backdrop-filter: blur(12px);
    }
</style>